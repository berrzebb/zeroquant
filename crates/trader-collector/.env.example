# Standalone Collector 환경변수 예제
# 사용법: cp .env.example .env
# 최신 업데이트: 2026-02-06
#
# ⚠️ 보안 주의사항:
# - API 키는 웹 UI [설정 > API 키]에서 관리합니다.
# - 이 파일에는 수집 설정만 포함됩니다.

# =====================================================
# DATABASE (필수)
# =====================================================
DATABASE_URL=postgresql://trader:trader_secret@localhost:5432/trader

# API 키 암호화 마스터 키 (DB에서 API 키 복호화용)
# ⚠️ trader-api와 동일한 값을 사용해야 합니다.
ENCRYPTION_MASTER_KEY=your-32-byte-encryption-key-base64

# =====================================================
# SYMBOL SYNC (심볼 동기화)
# =====================================================
# 최소 심볼 수 (이 수 이하면 동기화 실행)
SYMBOL_SYNC_MIN_COUNT=100

# KRX(한국거래소) 동기화 - KOSPI/KOSDAQ 전 종목 (~2,500개)
SYMBOL_SYNC_KRX=true

# Binance(암호화폐) 동기화 - USDT 거래 페어 (~300개)
SYMBOL_SYNC_BINANCE=false

# Yahoo Finance(미국 주식) 동기화 - S&P 500, NASDAQ 등
SYMBOL_SYNC_YAHOO=false
SYMBOL_SYNC_YAHOO_MAX=500

# =====================================================
# OHLCV COLLECTION (OHLCV 데이터 수집)
# =====================================================
# 배치당 처리할 심볼 수
OHLCV_BATCH_SIZE=50

# 데이터 갱신 기준 (일, 이전 데이터 재수집)
OHLCV_STALE_DAYS=1

# 요청 간 딜레이 (밀리초)
OHLCV_REQUEST_DELAY_MS=500

# 수집 대상 시장 (콤마로 구분, 비어있으면 전체)
# 사용 가능: KR (한국), US (미국), CRYPTO (암호화폐)
# OHLCV_TARGET_MARKETS=KR,US

# 동시 수집 심볼 수 (Semaphore 기반 동시성 제한)
# 높을수록 빠르지만 API rate limit 주의
OHLCV_CONCURRENT_LIMIT=5

# 타임프레임 설정 (콤마로 구분)
# 사용 가능: 5m, 15m, 30m, 1h, 1d, 1w
# 분봉/시간봉은 Yahoo Finance 60일 제한
OHLCV_TIMEFRAMES=1d

# 수집 기간 (YYYYMMDD, 미설정시 자동 계산)
# OHLCV_START_DATE=20240101
# OHLCV_END_DATE=20261231

# 최대 보존 기간 (년)
# 타임프레임별 기본: D1=3년, H1=90일, M1=7일
OHLCV_MAX_RETENTION_YEARS=3

# =====================================================
# FUNDAMENTAL COLLECTION (펀더멘털 데이터 수집)
# =====================================================
# 배치당 처리할 심볼 수
FUNDAMENTAL_BATCH_SIZE=50

# 데이터 갱신 기준 (일)
FUNDAMENTAL_STALE_DAYS=7

# 요청 간 딜레이 (밀리초)
FUNDAMENTAL_REQUEST_DELAY_MS=2000

# OHLCV 데이터 포함 여부
FUNDAMENTAL_INCLUDE_OHLCV=true

# =====================================================
# SIGNAL PERFORMANCE (신호 성과 계산)
# =====================================================
# 배치당 처리할 신호 수
SIGNAL_PERFORMANCE_BATCH_SIZE=100

# 성과 계산 기간 (일)
SIGNAL_PERFORMANCE_MIN_DAYS=1
SIGNAL_PERFORMANCE_MAX_DAYS=20

# =====================================================
# WATCHLIST (관심종목 우선 처리)
# =====================================================
# 관심종목 우선 처리 (OHLCV, Indicator, GlobalScore)
# true: watchlist 종목을 먼저 수집한 후 나머지 처리
PRIORITIZE_WATCHLIST=true

# =====================================================
# DAEMON MODE (데몬 모드 설정)
# =====================================================
# 3개 그룹으로 분리된 워크플로우:
#   - Group A: 외부 API (OHLCV, Fundamental)
#   - Group B: 랭킹 (Score, Screening, SignalPerf)
#   - Group C: 실시간 (Indicator, Macro)

# Group A: 외부 API 실행 주기 (분)
DAEMON_INTERVAL_MINUTES=60

# Group B: 랭킹 워크플로우 실행 주기 (분)
RANKING_INTERVAL_MINUTES=15

# Group C: 실시간 지표 실행 주기 (분)
REALTIME_INTERVAL_MINUTES=5

# =====================================================
# SCHEDULING (시장 운영 시간 기반 스케줄링)
# =====================================================
# 스케줄링 활성화
SCHEDULING_ENABLED=false

# KRX 장마감 후 지연 시간 (분)
# 15:30 장마감 → 16:30 수집 시작
SCHEDULING_KRX_DELAY_MINUTES=60

# 주말 건너뛰기
SCHEDULING_SKIP_WEEKENDS=true

# 휴일 건너뛰기
SCHEDULING_SKIP_HOLIDAYS=true

# =====================================================
# DATA PROVIDERS (데이터 프로바이더)
# ⚠️ API 키는 웹 UI에서 관리합니다.
# =====================================================
# KRX OPEN API 활성화
PROVIDER_KRX_API_ENABLED=false

# Yahoo Finance 활성화
PROVIDER_YAHOO_ENABLED=true

# 네이버 금융 크롤러 활성화
NAVER_FUNDAMENTAL_ENABLED=true
NAVER_REQUEST_DELAY_MS=300

# =====================================================
# LOGGING
# =====================================================
RUST_LOG=info,trader_collector=debug,trader_data=debug
